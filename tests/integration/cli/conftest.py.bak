"""
Fixtures for CLI integration tests.
"""

import pytest
from pathlib import Path
from agentpm.core.database.service import DatabaseService


@pytest.fixture
def test_db_service(tmp_path):
    """
    Create a test database service with in-memory SQLite.

    Returns:
        DatabaseService: Initialized database service for testing
    """
    db_path = tmp_path / ".agentpm" / "data" / "test.db"
    db_path.parent.mkdir(parents=True, exist_ok=True)

    # DatabaseService automatically initializes schema in __init__
    service = DatabaseService(str(db_path))

    yield service

    # Cleanup (no close method needed - connections are context-managed)
    if db_path.exists():
        db_path.unlink()
