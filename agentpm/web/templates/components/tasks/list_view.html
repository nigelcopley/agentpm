<!-- Task List View Component -->
<!-- Usage: Include this component in templates -->
<!-- Variables: tasks, work_items (required) -->

<div id="listViewContainer" class="view-container">
    <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
        <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-200 table-fixed">
                <thead class="bg-gray-50">
                    <tr>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-12">
                            <input type="checkbox" id="selectAllTasks" class="rounded border-gray-300 text-emerald-600 focus:ring-emerald-500" onchange="toggleAllTasks(this)">
                        </th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-1/4">Task</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-1/6">Work Item</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20">Type</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20">Status</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20">Priority</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16">Effort</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-24">Due Date</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-24">Assigned</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-24">Progress</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20">Updated</th>
                        <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider w-20">Actions</th>
                    </tr>
                </thead>
                <tbody class="bg-white divide-y divide-gray-200">
                    {% for task in tasks %}
                    <tr class="hover:bg-gray-50">
                        <td class="px-6 py-4 whitespace-nowrap">
                            <input type="checkbox" class="task-checkbox rounded border-gray-300 text-emerald-600 focus:ring-emerald-500" 
                                   value="{{ task.id }}" onchange="updateBulkActions()">
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="flex items-center">
                                <div class="flex-shrink-0 h-10 w-10">
                                    <div class="h-10 w-10 rounded-full bg-emerald-100 flex items-center justify-center">
                                        <i class="bi bi-list-task text-emerald-600"></i>
                                    </div>
                                </div>
                                <div class="ml-4">
                                    <div class="text-sm font-medium text-gray-900">
                                        <a href="{{ url_for('tasks.task_detail', task_id=task.id) }}" class="hover:text-emerald-600">
                                            {{ task.name }}
                                        </a>
                                    </div>
                                    {% if task.description %}
                                    <div class="text-sm text-gray-500 truncate max-w-xs">
                                        {{ task.description[:60] }}{% if task.description|length > 60 %}...{% endif %}
                                    </div>
                                    {% endif %}
                                </div>
                            </div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-sm text-gray-900 max-w-32">
                                {% set work_item = work_items|selectattr('id', 'equalto', task.work_item_id)|first %}
                                {% if work_item %}
                                    <a href="{{ url_for('work_items.work_item_detail', work_item_id=work_item.id) }}" 
                                       class="hover:text-emerald-600 block truncate" 
                                       title="{{ work_item.name }}">
                                        {{ work_item.name }}
                                    </a>
                                {% else %}
                                    <span class="text-gray-400">Unknown</span>
                                {% endif %}
                            </div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            {% include 'components/tasks/type_badge.html' %}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            {% include 'components/tasks/status_badge.html' %}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            {% include 'components/tasks/priority_indicator.html' %}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                            {% if task.effort_hours %}
                                {{ "%.1f"|format(task.effort_hours) }}h
                            {% else %}
                                <span class="text-gray-400">-</span>
                            {% endif %}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                            {% include 'components/tasks/due_date_indicator.html' %}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                            {% if task.assigned_to %}
                                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                                    {{ task.assigned_to }}
                                </span>
                            {% else %}
                                <span class="text-gray-400">Unassigned</span>
                            {% endif %}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                            {% include 'components/tasks/progress_indicator.html' %}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                            {% if task.updated_at %}
                                <div class="flex items-center">
                                    <i class="bi bi-clock text-gray-400 mr-1"></i>
                                    <span title="{{ task.updated_at.strftime('%Y-%m-%d %H:%M:%S') }}">
                                        {{ task.updated_at.strftime('%m-%d %H:%M') }}
                                    </span>
                                </div>
                            {% else %}
                                <span class="text-gray-400">-</span>
                            {% endif %}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                            <div class="flex items-center justify-end space-x-2">
                                <a href="{{ url_for('tasks.task_detail', task_id=task.id) }}" class="text-emerald-600 hover:text-emerald-900">
                                    <i class="bi bi-eye"></i>
                                </a>
                                <a href="{{ url_for('tasks.edit_task', task_id=task.id) }}" class="text-blue-600 hover:text-blue-900">
                                    <i class="bi bi-pencil"></i>
                                </a>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
