{# Skeleton Loaders - Reusable Loading State Components #}

{# Card Skeleton - For metric cards and standard cards #}
{% macro card_skeleton() %}
<div class="card animate-pulse">
    <div class="skeleton h-6 w-3/4 mb-4"></div>
    <div class="skeleton h-4 w-full mb-2"></div>
    <div class="skeleton h-4 w-5/6"></div>
</div>
{% endmacro %}

{# Metric Card Skeleton - For dashboard metric cards #}
{% macro metric_card_skeleton() %}
<div class="card">
    <div class="flex items-center animate-pulse">
        <div class="flex-shrink-0">
            <div class="skeleton w-8 h-8 rounded-lg"></div>
        </div>
        <div class="ml-4 flex-1">
            <div class="skeleton h-4 w-24 mb-2"></div>
            <div class="skeleton h-8 w-16"></div>
        </div>
    </div>
</div>
{% endmacro %}

{# Work Item Card Skeleton - For work item grid #}
{% macro work_item_card_skeleton() %}
<div class="card animate-pulse">
    <div class="card-header border-b border-gray-200">
        <div class="flex items-center justify-between">
            <div class="flex items-center space-x-3 flex-1">
                <div class="skeleton h-6 w-16"></div>
                <div class="skeleton h-6 w-20"></div>
            </div>
            <div class="skeleton h-4 w-12"></div>
        </div>
    </div>
    <div class="card-body">
        <div class="skeleton h-6 w-3/4 mb-3"></div>
        <div class="skeleton h-4 w-full mb-2"></div>
        <div class="skeleton h-4 w-5/6 mb-4"></div>
        <div class="flex items-center space-x-4">
            <div class="skeleton h-4 w-24"></div>
            <div class="skeleton h-4 w-20"></div>
        </div>
        <div class="mt-4">
            <div class="skeleton h-2 w-full rounded-full"></div>
        </div>
    </div>
</div>
{% endmacro %}

{# Task Row Skeleton - For task list rows #}
{% macro task_row_skeleton() %}
<div class="card animate-pulse">
    <div class="flex items-center justify-between">
        <div class="flex items-center space-x-4 flex-1">
            <div class="skeleton w-6 h-6 rounded-full"></div>
            <div class="flex-1">
                <div class="skeleton h-5 w-2/3 mb-2"></div>
                <div class="flex items-center space-x-4">
                    <div class="skeleton h-4 w-24"></div>
                    <div class="skeleton h-4 w-16"></div>
                    <div class="skeleton h-4 w-20"></div>
                </div>
            </div>
        </div>
        <div class="flex items-center space-x-2">
            <div class="skeleton h-8 w-20 rounded"></div>
            <div class="skeleton h-8 w-8 rounded"></div>
        </div>
    </div>
</div>
{% endmacro %}

{# Table Skeleton - For data tables #}
{% macro table_skeleton(rows=5) %}
<div class="animate-pulse">
    <table class="table">
        <thead>
            <tr>
                <th><div class="skeleton h-4 w-24"></div></th>
                <th><div class="skeleton h-4 w-32"></div></th>
                <th><div class="skeleton h-4 w-20"></div></th>
                <th><div class="skeleton h-4 w-16"></div></th>
            </tr>
        </thead>
        <tbody>
            {% for i in range(rows) %}
            <tr>
                <td><div class="skeleton h-4 w-20"></div></td>
                <td><div class="skeleton h-4 w-40"></div></td>
                <td><div class="skeleton h-4 w-16"></div></td>
                <td><div class="skeleton h-4 w-12"></div></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endmacro %}

{# Detail Page Skeleton - For detail pages #}
{% macro detail_page_skeleton() %}
<div class="animate-pulse space-y-6">
    {# Header #}
    <div class="mb-8">
        <div class="skeleton h-8 w-1/2 mb-2"></div>
        <div class="flex items-center space-x-4">
            <div class="skeleton h-6 w-20"></div>
            <div class="skeleton h-6 w-24"></div>
            <div class="skeleton h-6 w-16"></div>
        </div>
    </div>

    {# Main Content #}
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        <div class="lg:col-span-2 space-y-6">
            {{ card_skeleton() }}
            {{ card_skeleton() }}
            {{ card_skeleton() }}
        </div>
        <div class="space-y-6">
            {{ card_skeleton() }}
            {{ card_skeleton() }}
        </div>
    </div>
</div>
{% endmacro %}

{# Grid Skeleton - For card grids #}
{% macro grid_skeleton(columns=3, rows=2) %}
<div class="grid grid-cols-1 lg:grid-cols-{{ columns }} gap-6">
    {% for i in range(columns * rows) %}
    {{ work_item_card_skeleton() }}
    {% endfor %}
</div>
{% endmacro %}

{# List Skeleton - For list views #}
{% macro list_skeleton(items=5) %}
<div class="space-y-4">
    {% for i in range(items) %}
    {{ task_row_skeleton() }}
    {% endfor %}
</div>
{% endmacro %}

{# Loading Spinner - Inline spinner for buttons #}
{% macro spinner(size='sm') %}
{% if size == 'sm' %}
<div class="animate-spin rounded-full h-4 w-4 border-2 border-current border-t-transparent"></div>
{% elif size == 'md' %}
<div class="animate-spin rounded-full h-6 w-6 border-2 border-current border-t-transparent"></div>
{% else %}
<div class="animate-spin rounded-full h-8 w-8 border-3 border-current border-t-transparent"></div>
{% endif %}
{% endmacro %}

{# Loading Button State - Button with loading state #}
{% macro loading_button(text, loading_text='Loading...', variant='primary', size='md', type='button') %}
<button type="{{ type }}"
        class="btn btn-{{ size }} btn-{{ variant }}"
        x-data="{ loading: false }"
        @click="loading = true"
        :disabled="loading">
    <span x-show="!loading">{{ text }}</span>
    <span x-show="loading" class="flex items-center space-x-2">
        {{ spinner('sm') }}
        <span>{{ loading_text }}</span>
    </span>
</button>
{% endmacro %}

{# Form Loading State - Overlay for form submission #}
{% macro form_loading_overlay() %}
<div x-show="loading"
     x-transition:enter="transition ease-out duration-200"
     x-transition:enter-start="opacity-0"
     x-transition:enter-end="opacity-100"
     class="absolute inset-0 bg-white bg-opacity-75 flex items-center justify-center"
     style="display: none;">
    <div class="flex items-center space-x-3">
        {{ spinner('md') }}
        <span class="text-gray-700 font-medium">Submitting...</span>
    </div>
</div>
{% endmacro %}
