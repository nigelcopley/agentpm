<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modal Test</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
</head>
<body class="p-8">
    <h1 class="text-2xl font-bold mb-4">Modal Test</h1>
    
    <button 
        @click="window.ModalSystem.showKeyboardShortcuts()"
        class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600"
    >
        Test Modal
    </button>
    
    <button 
        @click="modalData.showModal('keyboard-shortcuts')"
        class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 ml-4"
    >
        Direct Modal
    </button>
    
    <div 
        id="global-modal"
        x-data="modalData"
        x-show="open"
        x-cloak
        @keydown.escape.window="hideModal()"
        class="fixed inset-0 z-[9999] flex items-center justify-center bg-gray-900/50 backdrop-blur-sm"
        style="display: none;"
    >
        <div
            @click.away="hideModal()"
            class="relative mx-4 w-full max-w-2xl rounded-xl border border-gray-200 bg-white p-6 shadow-2xl"
        >
            <template x-if="type === 'keyboard-shortcuts'">
                <div>
                    <div class="mb-6 flex items-center justify-between">
                        <h2 class="text-xl font-semibold text-gray-900">Keyboard Shortcuts</h2>
                        <button
                            type="button"
                            @click="hideModal()"
                            class="flex h-8 w-8 items-center justify-center rounded-lg text-gray-400 transition hover:bg-gray-100 hover:text-gray-600"
                        >
                            <i class="bi bi-x-lg"></i>
                        </button>
                    </div>
                    <div class="space-y-2">
                        <div class="flex items-center justify-between rounded-lg border border-gray-200 px-4 py-3">
                            <span class="text-sm text-gray-700">Global search</span>
                            <kbd class="rounded border border-gray-300 bg-gray-50 px-2 py-1 font-mono text-xs">âŒ˜K</kbd>
                        </div>
                        <div class="flex items-center justify-between rounded-lg border border-gray-200 px-4 py-3">
                            <span class="text-sm text-gray-700">Show keyboard shortcuts</span>
                            <kbd class="rounded border border-gray-300 bg-gray-50 px-2 py-1 font-mono text-xs">?</kbd>
                        </div>
                    </div>
                </div>
            </template>
        </div>
    </div>

    <script>
        // Modal data
        const modalData = {
            open: false,
            type: '',
            data: {},
            
            showModal(type, data = {}) {
                console.log('showModal called with:', type);
                this.type = type;
                this.data = data;
                this.open = true;
                console.log('Modal state:', this.open, this.type);
            },
            
            hideModal() {
                console.log('hideModal called');
                this.open = false;
                this.type = '';
                this.data = {};
            }
        };
        
        // Global modal system
        window.ModalSystem = {
            showKeyboardShortcuts() {
                console.log('ModalSystem.showKeyboardShortcuts called');
                const modal = document.getElementById('global-modal');
                console.log('Modal element:', modal);
                if (modal && modal.__x) {
                    console.log('Modal Alpine instance found, showing modal');
                    modal.__x.$data.showModal('keyboard-shortcuts');
                } else {
                    console.log('Modal element or Alpine instance not found');
                }
            }
        };
        
        // Debug info
        document.addEventListener('alpine:init', () => {
            console.log('Alpine.js initialized');
        });
        
        document.addEventListener('DOMContentLoaded', () => {
            console.log('DOM loaded');
            const modal = document.getElementById('global-modal');
            console.log('Modal element on load:', modal);
        });
    </script>
</body>
</html>
